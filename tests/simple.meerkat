service s {
    var x = 0;

    pub def inc_x = action { x = x + 1; };

    pub def y = x + 1;

    pub def inc_x_by = fn z => action { x = x + z; };
}

@test(s) {
    assert(x > -1);
    assert(y==1);
    do action { x = x + 1; };
    do inc_x;
    assert(x > 0);
    assert(y==3);
    do inc_x_by(3);
    assert(y==6);
}
